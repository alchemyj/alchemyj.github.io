<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Adding business logic · AlchemyJ</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Adding business logic "/><meta name="docsearch:version" content="4.0.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Adding business logic · AlchemyJ"/><meta property="og:type" content="website"/><meta property="og:url" content="//"/><meta property="og:description" content="# Adding business logic "/><meta property="og:image" content="/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="/css/atom-one-dark-reasonable.css"/><script src="/js/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="https://www.alchemyj.io" id="siteSubject1" target="_self"><span id="siteSubject2">Alchemy</span><span id="siteSubject3">J</span></a><span id="siteSubject4"> by</span><span> </span><a href="http://www.axisoft.com" rel="noopener noreferrer" data-type="external" data-content="http://www.axisoft.com" id="siteSubject5" target="_blank">Axisoft</a><a href="/versions"><h3>4.0.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"></ul></nav></div></header></div></div><div class="navPusher singleRowMobileNav"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="adding-business-logic"></a><a href="#adding-business-logic" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding business logic</h1>
<p>Any worksheets you currently working on that contains business logic is called business logic sheet(s). It needs to define the Input and output parameters in the <a href="../ConfiguringJavaApi/JavaApiClassWorksheet">Java API Class Worksheet</a> or <a href="../ConfiguringRestApi/RestApiEndpointGroupWorksheet">REST API Endpoint Group Worksheet</a>.</p>
<p>Here introduce a simple business logic definition about authentication with LDAP.</p>
<ol>
<li>Usually, the LDAP server information and Domain will not be the same for different environments, so, define the LDAP Server name and Domain in %%AppConfig</li>
</ol>
<p><a href="AddingBusinessLogicImg/image1.png"><img src="AddingBusinessLogicImg/image1.png" alt=""></a></p>
<ol start="2">
<li>Define a simple Business Worksheet and use the function =<a href="../../Reference/AJExtendedFunctions/ajAuthenLdap">ajAuthenLdap()</a>, in C9, key in the following formula. Then the input parameters are user name, password from cell C3 and C4. And the output result is C9 where it returns the authentication result.</li>
</ol>
<pre><code class="hljs">=ajAuthenLdap('%%AppConfig'!<span class="hljs-symbol">B5</span>, '%%AppConfig'!<span class="hljs-symbol">B6</span>, <span class="hljs-symbol">C3</span>, <span class="hljs-symbol">C4</span>,<span class="hljs-built_in">FALSE</span>)
</code></pre>
<p><a href="AddingBusinessLogicImg/image2.png"><img src="AddingBusinessLogicImg/image2.png" alt=""></a></p>
<ol start="3">
<li>The input parameters are single value in text format, thus set the Class  as String. The Data Addresses are Authentication!C3 and Authentication!C4. It's strongly recommended to use the ajGetAddress to set the Data Address, e.g. ajGetAddress(Authentication!C3), then when the cell address is changed due to adding or removing some range, it will be re-calculated automatically. The input configurations of this function as below screenshot.</li>
</ol>
<p><a href="AddingBusinessLogicImg/image3.png"><img src="AddingBusinessLogicImg/image3.png" alt=""></a></p>
<ol start="4">
<li>The output parameter is a boolean value, so, in the Functions section set the Return Class as Boolean. The Return Data Address is Authentication!C9. The figurations of this function as below screenshot.</li>
</ol>
<p><a href="AddingBusinessLogicImg/image4.png"><img src="AddingBusinessLogicImg/image4.png" alt=""></a></p>
<ol start="5">
<li>Input the range you have used on Business Logic worksheet in the Related Worksheets section of API Class Definition Sheet to create the linkage between Class Definition Sheet and Business Logic Sheet.</li>
</ol>
<p><a href="AddingBusinessLogicImg/image-20200102152247021.png"><img src="AddingBusinessLogicImg/image-20200102152247021.png" alt="image-20200102152247021"></a></p>
<ol start="6">
<li>Done! You can click the Run Function Point button on the AlchemyJ toolbar to test it. TRUE would be returned on the cell Authentication!C9 if the configuration and the inputted user name and password are  corrected. Otherwise, FALSE would be returned.</li>
</ol>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap" id="site_map"><table align="center" border="0"><tbody><tr><td align="right" id="copyrightTd"><span height="46px" id="copyright">Copyright © 2019 <a href="http://www.axisoft.com" target="_blank" data-content="http://www.axisoft.com" data-type="external" rel="noopener noreferrer" id="copyrightLink"> Axisoft (Asia Pacific) Limited.</a> All Rights Reserved.</span></td></tr></tbody></table></section></footer></div></body></html>