<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Constructing JSON · AlchemyJ</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Constructing JSON Strings"/><meta name="docsearch:version" content="4.0.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Constructing JSON · AlchemyJ"/><meta property="og:type" content="website"/><meta property="og:url" content="//"/><meta property="og:description" content="# Constructing JSON Strings"/><meta property="og:image" content="/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="/css/atom-one-dark-reasonable.css"/><script src="/js/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="https://www.alchemyj.io" id="siteSubject1" target="_self"><span id="siteSubject2">Alchemy</span><span id="siteSubject3">J</span></a><span id="siteSubject4"> by</span><span> </span><a href="http://www.axisoft.com" rel="noopener noreferrer" data-type="external" data-content="http://www.axisoft.com" id="siteSubject5" target="_blank">Axisoft</a><a href="/versions"><h3>4.0.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"></ul></nav></div></header></div></div><div class="navPusher singleRowMobileNav"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Data Handling</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Get Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.0.0/GetStarted/Overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/GetStarted/Prerequisites">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/GetStarted/Install">Install AlchemyJ</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/GetStarted/WriteYourFirstRESTAPI">Write Your First REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/GetStarted/PreviewYourFirstRESTAPI">Preview Your First REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/GetStarted/GenerateAndRunYourRESTAPI">Generate and Run Your REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/GetStarted/GoingFurther">Going Further</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Terms &amp; Concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.0.0/TerminologyAndConcepts/TerminologyAndConcepts">Terms and Concepts</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Recipe Book<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/Recipes">Recipes</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Database Operation</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/DatabaseOperation/AccessingDatabase">Accessing Database</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/DatabaseOperation/SingleTableMaintenance">Single Table Maintenance</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">File Operation</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/FileOperation/ReadAndWriteTextFile">Reading and Writing Text Files</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/FileOperation/ReadAndWriteExcelWorkbook">Reading and Writing Excel Workbook</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/FileOperation/UploadAndDownloadFileInDB">Uploading and Downloading File in Database</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">External API Integration</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/ExternalAPIIntegration/InvokingExternalAPI">Making Web Service Requests</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/ExternalAPIIntegration/CallingExternalJavaFunction">Calling External Java Functions</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Data Validation</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/DataValidation/DataValidationBackend">Data Validation (Backend)</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/DataValidation/DataValidationUI">Data Validation (UI)</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Data Handling</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/DataHandling/ReturningMultipleCells">Returning Multiple Cells</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/4.0.0/RecipeBook/DataHandling/ConstructingJSON">Constructing JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/DataHandling/ParsingJSON">Parsing JSON</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/DataHandling/ConstructingXML">Constructing XML</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Control</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/AccessControl/AuthenticationWithLdap">Authentication with LDAP</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/AccessControl/AuthenticationForRESTAPI">Authentication for REST API</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/SendingEmail">Sending Email</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/ConfigurationExternalization">Reading External Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/ErrorHandling">Error Handling</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/WorkingOnMultipleWorkbooks">Team Development using AlchemyJ</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/RecipeBook/PerformanceNOptimization">Improving Performance</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Development<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/Guideline">Guideline</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJStudio">AlchemyJ Studio</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">AlchemyJ Workbook</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/Introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/CreateAlchemyJWorkbook">Create AlchemyJ Workbook</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/SysRuntimeWorksheet">System Runtime Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/AppConfigWorksheet">Application Configuration Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/JavaAPIPackageWorksheet">Java API Package Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/JavaAPIClassWorksheet">Java API Class Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/RESTAPIWorksheet">REST API Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/RESTAPIEndpointGroupWorksheet">REST API Endpoint Group Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/RESTAPILoginServiceWorksheet">REST API Login Service Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/RESTAPITokenAuthorizationWorksheet">REST API Token Authorization Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/RESTAPIUserDetailsServiceWorksheet">REST API User Details Service Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/RESTAPIEndpointSecurityWorksheet">REST API Endpoint Security Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/DbSchemaWorksheet">DB Schema Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/DataDictionaryWorksheet">Data Dictionary Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/AlchemyJWorkbook/DataRelationshipSchema">Data Relationship Schema</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Business Logic</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/BusinessLogic/DefineBusinessLogic">Define Business Logic</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/BusinessLogic/BusinessModelingBestPractice">Business Modeling Best Practice</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Java API</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/JavaAPI/DefineJavaAPIClass">Define Java API Class</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/JavaAPI/DefineJavaAPIPackage">Define Java API Package</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/JavaAPI/IntegrateJavaAPIWithJavaProject">Integrate Java API in a Java project</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">REST API</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/RESTAPI/DefineRESTAPIEndpointGroup">Define REST API Endpoint Group</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/RESTAPI/DefineRESTAPI">Define REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/RESTAPI/EnableRESTSecurity">Enable REST API Security</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/GenerateAPI">Generate API</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">OpenAPI Spec for REST API</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/OpenAPISpecForRESTAPI/Introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/OpenAPISpecForRESTAPI/EnableOpenAPISpec">Enable OpenAPI Specification Generation</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/OpenAPISpecForRESTAPI/OpenAPISpecContentSource">OpenAPI Specification Content Source</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Development/OpenAPISpecForRESTAPI/TryYourRESTAPI">Try Your REST API</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Testing &amp; Troubleshooting<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Testing</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/TestingAndTroubleshooting/Testing/Introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/TestingAndTroubleshooting/Testing/TestTemplate">Test Template</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/TestingAndTroubleshooting/Testing/UsingTestTemplate">Using Test Template</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">API Troubleshooting</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/TestingAndTroubleshooting/APITroubleshooting/APIInspectorSettings">API Inspector Settings</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/TestingAndTroubleshooting/APITroubleshooting/UsingAPIInspector">Using API Inspector</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Reference<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">AlchemyJ Extended Functions</h4><ul><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/Index">Index</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajAuthenLdap">ajAuthenLdap</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajCallFunction">ajCallFunction</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajCallWsRest">ajCallWsRest</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajCallWsSoap">ajCallWsSoap</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajCheckDataItem">ajCheckDataItem</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajCheckFileExists">ajCheckFileExists</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajCopyFile">ajCopyFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajCountRec">ajCountRec</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajCreateRec">ajCreateRec</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajDeleteFile">ajDeleteFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajDeleteRec">ajDeleteRec</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajDownloadLob">ajDownloadLob</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajExecuteSp">ajExecuteSp</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajExecuteSql">ajExecuteSql</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajFilterArray">ajFilterArray</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajFilterJson">ajFilterJson</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajGetAddress">ajGetAddress</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajGetLastUsedCellAddress">ajGetLastUsedCellAddress</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajGetModelError">ajGetModelError</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajGetSystemError">ajGetSystemError</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajGetUsedRangeAddress">ajGetUsedRangeAddress</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajMakeJson">ajMakeJson</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajMakeJsonFromSchema">ajMakeJsonFromSchema</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajMakeJsonFromTable">ajMakeJsonFromTable</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajMakeXML">ajMakeXML</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajMakeXMLFromSchema">ajMakeXMLFromSchema</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajMakeXMLFromTable">ajMakeXMLFromTable</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajMergeRec">ajMergeRec</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajMoveFile">ajMoveFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajPopulateJsonToTable">ajPopulateJsonToTable</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajRaiseError">ajRaiseError</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajReadFile">ajReadFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajReadRec">ajReadRec</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajReadWorkbook">ajReadWorkbook</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajRegExpCount">ajRegExpCount</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajRegExpMatch">ajRegExpMatch</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajRenameFile">ajRenameFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajSendEmail">ajSendEmail</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajSortArray">ajSortArray</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajUpdateRec">ajUpdateRec</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajUploadLob">ajUploadLob</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajWriteFile">ajWriteFile</a></li><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/AJExtendedFunctions/ajWriteWorkbook">ajWriteWorkbook</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Reference/SupportedExcelFunctions">Supported Excel functions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">FAQ<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/4.0.0/Faq/Faq">FAQ</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="constructing-json-strings"></a><a href="#constructing-json-strings" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Constructing JSON Strings</h1>
<p>JSON (JavaScript Object Notation) is a lightweight data-interchange format and it is commonly used in REST web service. AlchemyJ provides multiple ways to construct a JSON string. They are as follow:</p>
<p><a href="../../Reference/AJExtendedFunctions/ajMakeJson">ajMakeJson</a></p>
<p><a href="../../Reference/AJExtendedFunctions/ajMakeJsonFromTable">ajMakeJsonFromTable</a></p>
<p><a href="../../Reference/AJExtendedFunctions/ajMakeJsonFromSchema">ajMakeJsonFromSchema</a></p>
<p>The above functions are often used to construct a REST API response.</p>
<h2><a class="anchor" aria-hidden="true" id="ajmakejson"></a><a href="#ajmakejson" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ajMakeJson</h2>
<p>ajMakeJson returns a JSON string given a corresponding name and value pair. If the value of
the JSON name-value pair contains multiple records, a JSON array will be returned. It only supports a single table.  For returning multiple tables, use ajMakeJsonFromSchema instead.</p>
<p>ajMakeJson function supports both row array and column array.</p>
<h3><a class="anchor" aria-hidden="true" id="case-1-get-a-json-array-with-ajmakejson"></a><a href="#case-1-get-a-json-array-with-ajmakejson" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Case 1: Get a JSON Array with ajMakeJson</h3>
<p>For example, below is a customer list that needs to be returned by a function point.  We will use ajMakeJson to construct the function point response.</p>
<p><a href="ConstructingJsonImg/image-20200114155341387.png"><img src="ConstructingJsonImg/image-20200114155341387.png" alt="image-20200114155341387"></a></p>
<p>ajMakeJson has four parameters.  In this example, we only need to define the first two parameters of ajMakeJson. Cell B3 to F3 define the header range (first parameter) while cell B4 to F8 defines the data range (second parameter).</p>
<pre><code class="hljs">=ajMakeJson(header,data,data_type,exclude_column)
</code></pre>
<p>As ajMakeJson returns a string, highlight the cell you want the data to be returned, type in =ajMakeJson(B3:F3,B4:F8) and the customer table will be converted to a JSON array as shown below.</p>
<pre><code class="hljs">[{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"CHAN TAI MAN"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28127</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"5"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22205555"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"JERRY SZE"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32239</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22203333"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MERRY SO"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32205</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"4"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22201111"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MICKY MAI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32271</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"3"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22206666"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"TOM HUI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28827</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"1"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22204444"</span>}]
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="case-2-get-a-json-object-with-ajmakejson"></a><a href="#case-2-get-a-json-object-with-ajmakejson" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Case 2: Get a JSON Object with ajMakeJson</h3>
<p>For the same customer list as Case 1, if you want to get a JSON object, then you can do as follow:</p>
<p><a href="ConstructingJsonImg/image-20200114162219513.png"><img src="ConstructingJsonImg/image-20200114162219513.png" alt="image-20200114162219513"></a></p>
<p>Input a data range in cell C12.</p>
<pre><code class="hljs">=ajGetAddress(<span class="hljs-symbol">B3</span>:<span class="hljs-symbol">F3</span>) &amp; <span class="hljs-string">","</span> &amp; ajGetAddress(<span class="hljs-symbol">B4</span>:<span class="hljs-symbol">F8</span>)
</code></pre>
<p>In this example, input the data item name as [customers] in B12. Then use =ajMakeJson(B12:B12,C12:C12)and you will have a JSON Object as shown below.</p>
<pre><code class="hljs">{<span class="hljs-attr">"customers"</span>:[{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"CHAN TAI MAN"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28127</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"5"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22205555"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"JERRY SZE"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32239</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22203333"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MERRY SO"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32205</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"4"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22201111"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MICKY MAI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32271</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"3"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22206666"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"TOM HUI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28827</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"1"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22204444"</span>}]}

</code></pre>
<h3><a class="anchor" aria-hidden="true" id="case-3-ajmakejson-for-a-column-array"></a><a href="#case-3-ajmakejson-for-a-column-array" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Case 3: ajMakeJson for a column array</h3>
<p>ajMakeJson function can also handle column array. In this example, the customer list is transposed as shown below. B2:B6 is the header range and C2:G6 is the data range.</p>
<p><a href="ConstructingJsonImg/image-20200114175255325.png"><img src="ConstructingJsonImg/image-20200114175255325.png" alt="image-20200114175255325"></a></p>
<p>As ajMakeJson returns a string, highlight the cell you want the data to be returned to, type in =ajMakeJson(B2:B6,C2:G6) and the customer table will be converted to a JSON array. It returns the same result as in case 1.</p>
<h2><a class="anchor" aria-hidden="true" id="ajmakejsonfromtable"></a><a href="#ajmakejsonfromtable" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ajMakeJsonFromTable</h2>
<p>ajMakeJsonFromTable is a quick way to turn a table of data into a JSON string. For returning multiple tables, use ajMakeJsonFromSchema instead.</p>
<pre><code class="hljs">=ajMakeJsonFromTable(header,data,data_name,data_type,exclude_column)
</code></pre>
<p>Take the same example in <a href="#case-2-get-a-Json-object-with-ajMakeJson">Case 2</a>: Get a JSON Object with ajMakeJson, we can use =ajMakeJsonFromTable(B3:F3,B4:F8,&quot;customers&quot;)  to achieve the same result.</p>
<p><a href="ConstructingJsonImg/image-20200114155341387.png"><img src="ConstructingJsonImg/image-20200114155341387.png" alt="image-20200114155341387"></a></p>
<p>Return Result:</p>
<pre><code class="hljs">{<span class="hljs-attr">"customers"</span>:[{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"CHAN TAI MAN"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28127</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"5"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22205555"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"JERRY SZE"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32239</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22203333"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MERRY SO"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32205</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"4"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22201111"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MICKY MAI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32271</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"3"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22206666"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"TOM HUI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28827</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"1"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22204444"</span>}]}

</code></pre>
<h2><a class="anchor" aria-hidden="true" id="ajmakejsonfromschema"></a><a href="#ajmakejsonfromschema" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ajMakeJsonFromSchema</h2>
<p>ajMakeJsonFromSchema is good for constructing JSON string from tables that are related based on the definition of a Data Relationship Schema which needs to be defined first.</p>
<pre><code class="hljs">=ajMakeJsonFromSchema(tables_relationship_header,tables_relationship)
</code></pre>
<p>Here is a sample to construct a JSON string for Client and Order tables.</p>
<p><a href="ConstructingJsonImg/image-20200114184032107.png"><img src="ConstructingJsonImg/image-20200114184032107.png" alt="image-20200114184032107"></a></p>
<p>There are 3 records in Client tables and the key is Client ID. There are also 3 records in Order table and the foreign key is Client ID.</p>
<p>Data Relationship Schema must follow a specific format. Refer to <a href="../../Development/AlchemyJWorkbook/DataRelationshipSchema">Data Relationship Schema</a> for the columns required. In this example, A15:I15 is the Data Relationship Schema header and A16:I17 is the Data Relationship Schema data range. Enter the formula =ajMakeJsonFromSchema(A15:I15,A16:I17) in cell B20.</p>
<p><a href="ConstructingJsonImg/image-20200114184749069.png"><img src="ConstructingJsonImg/image-20200114184749069.png" alt="image-20200114184749069"></a></p>
<p>The function generates a JSON string with a hierarchy based on the Data Relationship Schema. In this example, the order table is linked to the client table based on client ID. The JSON result shows that only client 1234567890001 has an order list since the order table only contains client 1234567890001.</p>
<p><a href="ConstructingJsonImg/image-20200114183945344.png"><img src="ConstructingJsonImg/image-20200114183945344.png" alt="image-20200114183945344"></a></p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/4.0.0/RecipeBook/DataHandling/ReturningMultipleCells"><span class="arrow-prev">← </span><span>Returning Multiple Cells</span></a><a class="docs-next button" href="/docs/4.0.0/RecipeBook/DataHandling/ParsingJSON"><span>Parsing JSON</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#ajmakejson">ajMakeJson</a><ul class="toc-headings"><li><a href="#case-1-get-a-json-array-with-ajmakejson">Case 1: Get a JSON Array with ajMakeJson</a></li><li><a href="#case-2-get-a-json-object-with-ajmakejson">Case 2: Get a JSON Object with ajMakeJson</a></li><li><a href="#case-3-ajmakejson-for-a-column-array">Case 3: ajMakeJson for a column array</a></li></ul></li><li><a href="#ajmakejsonfromtable">ajMakeJsonFromTable</a></li><li><a href="#ajmakejsonfromschema">ajMakeJsonFromSchema</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap" id="site_map"><table align="center" border="0"><tbody><tr><td align="right" id="copyrightTd"><span height="46px" id="copyright">Copyright © 2019 <a href="http://www.axisoft.com" target="_blank" data-content="http://www.axisoft.com" data-type="external" rel="noopener noreferrer" id="copyrightLink"> Axisoft (Asia Pacific) Limited.</a> All Rights Reserved.</span></td></tr></tbody></table></section></footer></div></body></html>