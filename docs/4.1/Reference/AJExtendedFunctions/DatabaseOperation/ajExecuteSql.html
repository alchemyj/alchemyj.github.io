<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>ajExecuteSql function · AlchemyJ</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# ajExecuteSql function"/><meta name="docsearch:version" content="4.1"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="ajExecuteSql function · AlchemyJ"/><meta property="og:type" content="website"/><meta property="og:url" content="//"/><meta property="og:description" content="# ajExecuteSql function"/><meta property="og:image" content="/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="/css/atom-one-dark-reasonable.css"/><script src="/js/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="https://www.alchemyj.io" id="siteSubject1" target="_self"><span id="siteSubject2">Alchemy</span><span id="siteSubject3">J</span></a><span id="siteSubject4"> by</span><span> </span><a href="http://www.axisoft.com" rel="noopener noreferrer" data-type="external" data-content="http://www.axisoft.com" id="siteSubject5" target="_blank">Axisoft</a><a href="/versions"><h3>4.1</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"></ul></nav></div></header></div></div><div class="navPusher singleRowMobileNav"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="ajexecutesql-function"></a><a href="#ajexecutesql-function" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ajExecuteSql function</h1>
<h2><a class="anchor" aria-hidden="true" id="description"></a><a href="#description" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h2>
<p>The ajExecuteSql function executes a SQL statement and returns the result.</p>
<h2><a class="anchor" aria-hidden="true" id="syntax"></a><a href="#syntax" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Syntax</h2>
<p>ajExecuteSql(sql_statement, [parameter], [return_type], [transpose], [return_header], [data_source_id], [convert_to_text], [run_condition],[run_by_function_point_only])</p>
<table>
<thead>
<tr><th><strong>Argument Name</strong></th><th><strong>Description</strong></th></tr>
</thead>
<tbody>
<tr><td>sql_statement <br/>(required)</td><td>The range of cells to form the SQL statement to be executed. The range of cells can span across multiple rows  and columns. <br />Please take note that only a single SQL  syntax is supported. For example, this function does not support “;” combine with  other SQL statements.<br />For security best practices, it is  recommended to use ‘?’ or ‘:<key> (Oracle only) placeholder in the  query string. Such placeholders will be replaced with parameters from the  ‘parameter’ argument. For example, data sanitization will be performed to prevent SQL injection.</td></tr>
<tr><td>parameter <br/>(optional)</td><td>The range of cells to form the list of  input and output parameters to be specified in the following format. The range of cells can span across multiple rows and columns.<br />&lt;field_name&gt;-##-&lt;value&gt;-##-&lt;data_type&gt;-##-&lt;in_out_flag&gt;-||- <br />&lt;field_name&gt;-##-&lt;value&gt;-##-&lt;data_type&gt;-##-&lt;in_out_flag&gt;-||- ...<br />Where,   <br />-||-  denotes AlchemyJ parameter separator.<br/>-##- denotes AlchemyJ parameter type  separator.<br />For example,  <br />RECORD_ID1-##-21-##-NUMBER-##-IN-||- RECORD_ID2-##-23-##-<br />NUMBER-##-IN-||- OUTPUT -##- NUMBER -##- OUT<br />Please take note that both separator symbols can be configured in <a href="../../../Development/AlchemyJWorkbook/AppConfigWorksheet">%%AppConfig Worksheet</a>. If you do not specify anything, the default value will always be an empty string (“”).</td></tr>
<tr><td>return_type  <br/>(optional)</td><td>0 indicates the function will return a set of records (in cell array).  <br />1 indicates the function will return the output parameters.  <br />2 indicates to return the number of the affected records. <br />If you do not specify anything, the default value will always be 0.</td></tr>
<tr><td>transpose  <br/>(optional)</td><td>If it equals TRUE, the return result will be transposed.  This only affects the return that has multiple cells. If you do not specify anything, the default value will always be FALSE.</td></tr>
<tr><td>return_header <br/>(optional)</td><td>If it equals TRUE, the return result will include the column headers as the first row.  <br />If it equals FALSE, the return result will contain data only. <br />This only applies when ‘return_type’ is 0. <br />If you do not specify anything, the default value will always be FALSE.</td></tr>
<tr><td>data_source_id <br/>(optional)</td><td><p>Specify the data  source ID. The parameter is used to define which database shall be executed  for the function.</p>If you do not specify anything, the default value will always  be 'primary'.</td></tr>
<tr><td>convert_to_text <br/>(optional)</td><td>If it equals TRUE, the return result will be converted to string values.  <br />If it equals FALSE, the return result will preserve the original data type but any string value that has more than 256 characters will cause an error.    <br />If you do not specify anything, the  default value will always be FALSE.</td></tr>
<tr><td>run_condition <br/> (optional)</td><td><p>The function will run when the value is TRUE. Otherwise, it will not run. </p>If you do not specify anything, the default value will always be TRUE.</td></tr>
<tr><td>run_by_function_point_only <br/>(optional)</td><td><p>If it equals FALSE, the function can be executed through ‘Excel Calculation’ (can be either <strong>Automatic</strong> or <strong>Manual</strong>, <strong>Calculate Now</strong> or <strong>Calculate Sheet</strong>) or <strong>Run Function Point</strong>. </p><p>If it equals TRUE, the function can be executed with <strong>Run Function Point</strong> (AlchemyJ toolbar \ Run Function Point) only.</p>If you do not specify anything, the default value will always be TRUE.</td></tr>
</tbody>
</table>
<p>The function will return:</p>
<ol>
<li>Content type: Database operations results or the count</li>
<li>Method: Within a cell / cell array</li>
</ol>
<p>Before using ExecuteSQL, the database connection must be set up from the <a href="../../../Development/AlchemyJStudio#properties">Properties</a> dialog box.</p>
<h2><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h2>
<p>Below is the SQL statement we will execute and the expected result.</p>
<p><a href="ajExecuteSqlImg/image1.png"><img src="ajExecuteSqlImg/image1.png" alt=""></a></p>
<p>ajExecuteSql returns a set of records in the defined cell range.</p>
<p><a href="ajExecuteSqlImg/image2.png"><img src="ajExecuteSqlImg/image2.png" alt=""></a></p>
<p>#VALUE! will be returned when there is an error in the usage of the function.</p>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#description">Description</a></li><li><a href="#syntax">Syntax</a></li><li><a href="#example">Example</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap" id="site_map"><table align="center" border="0"><tbody><tr><td align="right" id="copyrightTd"><span height="46px" id="copyright">Copyright © 2019 <a href="http://www.axisoft.com" target="_blank" data-content="http://www.axisoft.com" data-type="external" rel="noopener noreferrer" id="copyrightLink"> Axisoft.</a> All Rights Reserved.</span></td></tr></tbody></table></section></footer></div></body></html>