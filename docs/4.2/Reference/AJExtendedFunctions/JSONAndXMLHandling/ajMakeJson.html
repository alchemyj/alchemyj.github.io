<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>ajMakeJson · AlchemyJ</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# ajMakeJson function"/><meta name="docsearch:version" content="4.2"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="ajMakeJson · AlchemyJ"/><meta property="og:type" content="website"/><meta property="og:url" content="//"/><meta property="og:description" content="# ajMakeJson function"/><meta property="og:image" content="/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="/css/atom-one-dark-reasonable.css"/><script src="/js/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="https://www.alchemyj.io" id="siteSubject1" target="_self"><span id="siteSubject2">Alchemy</span><span id="siteSubject3">J</span></a><span id="siteSubject4"> by</span><span> </span><a href="http://www.axisoft.com" rel="noopener noreferrer" data-type="external" data-content="http://www.axisoft.com" id="siteSubject5" target="_blank">Axisoft</a><a href="/versions"><h3>4.2</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"></ul></nav></div></header></div></div><div class="navPusher singleRowMobileNav"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="ajmakejson-function"></a><a href="#ajmakejson-function" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ajMakeJson function</h1>
<h2><a class="anchor" aria-hidden="true" id="description"></a><a href="#description" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Description</h2>
<p>The ajMakeJson function returns a JSON string with a corresponding name and value pair. If the value of the JSON name-value pair contains multiple records, a JSON array will be returned.</p>
<p>the following formula:</p>
<p>=ajMakeJson(“name”, “value”)</p>
<p>will formulate the JSON string and return the following:</p>
<p>{&quot;name&quot;:&quot;value&quot;}</p>
<h2><a class="anchor" aria-hidden="true" id="syntax"></a><a href="#syntax" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Syntax</h2>
<p>ajMakeJson(header, data, [data_type], [exclude_column])</p>
<table>
<thead>
<tr><th><strong>Argument Name</strong></th><th><strong>Description</strong></th></tr>
</thead>
<tbody>
<tr><td>header  (required)</td><td>The range of cells to be set as the name of the JSON  name-value pair. It can be selected either vertically or horizontally.  <br/><br/>You can also merge multiple columns into one by giving  consecutive columns with the same name and index suffix as shown below  <br/><br/>&lt;field_name&gt;__&lt;running_number_from_01&gt;: <br/><br/> For example, you have a field called Description, and it  should be 60000 characters long which is longer than the capacity limit of a single cell in Excel. Therefore, two columns, Description__01 and Description__02 are used.  ajMakeJson will concatenate the values and the node name in the return JSON which would be Description.<br/><br/> If a header name is surrounded by [], the content will be  treated as the input parameter of a nested ajMakeJson call which returns an array of JSON objects. Use asterisk &quot;*&quot; to join header and data addresses. For example, A1:B1*A2:B4. This means A1 to B1 is the header range of the nested list,  and A2 to B4 are the three rows of data.  <br/><br/>If a header name is surrounded by {}, the content will be  treated as the input parameter of a nested ajMakeJson call which returns a  JSON object.  <br/><br/>{} and [] headers can create JSON strings with multiple level  nodes. As the content expects a string that contains cell a range address, it  is recommended to use ajGetAddress to return an address range string. Refer  to ajGetAddress for more details. <br/><br/></td></tr>
<tr><td>data  <br/>(required)</td><td>The range of cells to be set as the value of the JSON  name-value pair. It can be selected either vertically or horizontally but  must be the same as ‘Header’.  <br/><br/>For example, if ‘Header’ is selected vertically, ‘Data’ must be selected vertically as well.  <br/><br/>If a single record is selected, the result will be a JSON  object.  <br/><br/>If multiple records are selected, the result will be a JSON array.<br/><br/></td></tr>
<tr><td>data_type  <br/>(Optional)</td><td>Specify the data type of the fields (‘Header’) in the  format below. The following data type supported in AlchemyJ are number, integer,  boolean and string. Fields that do not exist will be ignored. The fields specified here will also be applied to nested ajMakeJson call using [] and {}  headers.  <br/><br/>&lt;field_name&gt;-##-&lt;data_type&gt;-||-&lt;field_name&gt;-##-&lt;data_type&gt;-||-...  <br/><br/>Where,  <br/><br/>-||- denotes AlchemyJ parameter separator.  <br/><br/>-##- denotes AlchemyJ parameter type separator.  <br/><br/>For example, ID-##-number-||-Name-##-string  <br/><br/>Please take note that both separator symbols can be  configured in %%AppConfig worksheet.  <br/><br/>If you do not specify anything, the default data type will follow  the cell data type.  <br/><br/></td></tr>
<tr><td>exclude_column  <br/>(Optional)</td><td>Specify the fields to be excluded from the result. Fields  that do not exist will be ignored. The fields specified here will also be applied  to nested ajMakeJson call using [] and {} headers. <br/><br/> &lt;field_name&gt;-||-&lt;field_name&gt;-||-...  <br/><br/>Where,  <br/><br/>-||- denotes AlchemyJ parameter separator.  <br/><br/>For example, ID-||-Last Name  <br/><br/>Please take note that the parameter separator symbols can be  configured in %%AppConfig worksheet.  <br/><br/>If you do not specify anything, no fields will be excluded.  <br/><br/></td></tr>
</tbody>
</table>
<p>The function will return:</p>
<p>1) Content type: JSON object / JSON array</p>
<p>2) Method: Within a cell / row cell array</p>
<h2><a class="anchor" aria-hidden="true" id="examples"></a><a href="#examples" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Examples</h2>
<p>Here are a few examples of ajMakeJson function.</p>
<h3><a class="anchor" aria-hidden="true" id="example-1"></a><a href="#example-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example 1</h3>
<p>As you can see from the example below, the name and value of the JSON name-value pairs are spanned across A10:D10 and A11:D13 respectively.</p>
<p>Please take note that the range of cells in both arguments is spanned horizontally and a JSON string is returned.</p>
<p><a href="ajMakeJsonImg/image2.png"><img src="ajMakeJsonImg/image2.png" alt=""></a></p>
<p>If the JSON string is too large, the return value can be specified in a row cell array.</p>
<h3><a class="anchor" aria-hidden="true" id="example-2"></a><a href="#example-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example 2</h3>
<p>This example is similar to Example 1. The only difference is that the range of cells is declared vertically instead of horizontally.</p>
<p><a href="ajMakeJsonImg/image1.png"><img src="ajMakeJsonImg/image1.png" alt=""></a></p>
<h3><a class="anchor" aria-hidden="true" id="example-3"></a><a href="#example-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example 3</h3>
<p>From the example below you can see, the header <strong>Phone</strong> is surrounded by <strong>[]</strong>, then the value will be treated as the parameters of a nested call of ajMakeJson. The formula is in B41 is '=ajGetAddress(D22:E22)&amp;&quot;*&quot;&amp;ajGetAddress(D23:E24)'</p>
<p><a href="ajMakeJsonImg/image3.png"><img src="ajMakeJsonImg/image3.png" alt=""></a></p>
<p>The JSON returned:</p>
<pre><code class="hljs css language-json">{
    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">"Phone"</span>: [
        {
            <span class="hljs-attr">"Number"</span>: <span class="hljs-number">22233621</span>,
            <span class="hljs-attr">"Type"</span>: <span class="hljs-string">"Home"</span>
        },
        {
            <span class="hljs-attr">"Number"</span>: <span class="hljs-number">22216247</span>,
            <span class="hljs-attr">"Type"</span>: <span class="hljs-string">"Office"</span>
        }
    ]
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="example-4"></a><a href="#example-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example 4</h3>
<p>This example is similar to example 3, the only difference is the <strong>Phone</strong> is surrounded by <strong>{}</strong>. Please take note that the nested call of ajMakeJson would only return the first row of the value.</p>
<p><a href="ajMakeJsonImg/image4.png"><img src="ajMakeJsonImg/image4.png" alt=""></a></p>
<p>The JSON returned:</p>
<pre><code class="hljs css language-json">{
    <span class="hljs-attr">"ID"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">"Phone"</span>: {
        <span class="hljs-attr">"Number"</span>: <span class="hljs-number">22233621</span>,
        <span class="hljs-attr">"Type"</span>: <span class="hljs-string">"Home"</span>
    }
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#description">Description</a></li><li><a href="#syntax">Syntax</a></li><li><a href="#examples">Examples</a><ul class="toc-headings"><li><a href="#example-1">Example 1</a></li><li><a href="#example-2">Example 2</a></li><li><a href="#example-3">Example 3</a></li><li><a href="#example-4">Example 4</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap" id="site_map"><table align="center" border="0"><tbody><tr><td align="right" id="copyrightTd"><span height="46px" id="copyright">Copyright © 2019 <a href="http://www.axisoft.com" target="_blank" data-content="http://www.axisoft.com" data-type="external" rel="noopener noreferrer" id="copyrightLink"> Axisoft.</a> All Rights Reserved.</span></td></tr></tbody></table></section></footer></div></body></html>