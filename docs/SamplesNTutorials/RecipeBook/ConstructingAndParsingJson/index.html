<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Constructing JSON String · AlchemyJ</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Constructing JSON Strings"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Constructing JSON String · AlchemyJ"/><meta property="og:type" content="website"/><meta property="og:url" content="//"/><meta property="og:description" content="# Constructing JSON Strings"/><meta property="og:image" content="/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="/css/atom-one-dark-reasonable.css"/><script src="/js/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="https://www.alchemyj.io" id="siteSubject1" target="_self"><span id="siteSubject2">Alchemy</span><span id="siteSubject3">J</span></a><span id="siteSubject4"> by</span><span> </span><a href="http://www.axisoft.com" rel="noopener noreferrer" data-type="external" data-content="http://www.axisoft.com" id="siteSubject5" target="_blank">Axisoft</a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://www.alchemyj.io/features" target="_self">Features</a></li><li class=""><a href="https://www.alchemyj.io/contact-us" target="_self">Contact Us</a></li><li class="siteNavGroupActive"><a href="/docs/GetStarted/GetStarted" target="_self">Docs</a></li><li class=""><a href="https://www.alchemyj.io/about-us" target="_self">About Us</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Recipe book</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Get started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/GetStarted/GetStarted">Get started</a></li><li class="navListItem"><a class="navItem" href="/docs/GetStarted/Install">Install AlchemyJ</a></li><li class="navListItem"><a class="navItem" href="/docs/GetStarted/SetupYourMicrosoftExcel">Set up your Microsoft Excel</a></li><li class="navListItem"><a class="navItem" href="/docs/GetStarted/WriteYourFirstRestApi">Write your first REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/GetStarted/PreviewYourFirstRestApi">Preview your first REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/GetStarted/BuildAndRunYourRestApi">Build and run your REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/GetStarted/GoingFurther">Going further</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Terms &amp; concepts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/TerminologyAndConcepts/TerminologyAndConcepts">Terms and concepts</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Samples &amp; tutorials<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Recipe book</h4><ul><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/RecipeBook">Recipes</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/AccessingDatabase">Accessing database</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/DataValidationBackend">Data validation (Backend)</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/DataValidationUi">Data validation (UI)</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/WorkingWithExternalFile">Reading and writing text files</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/InvokingExternalApi">Making web service requests</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/SendingEmail">Sending email</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/CatchingTheError">Raising exceptions</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/UsingArrayForLibraryFunction">Returning multiple cells</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/ConstructingAndParsingJson">Constructing JSON strings</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/ParsingJsonString">Parsing JSON strings</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/HavingApplicationConfigurations">Reading application configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/PerformanceNOptimization">Improve performance</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/AuthenticationWithLdap">Authenticating a user in Java APIs</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/IntegratingWithYourExistingCode">Using AlchemyJ Java API in a project</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/CallingExternalJavaFunction">Calling external Java functions</a></li><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/RecipeBook/SettingUpTheLicenseFile">Setting up the license file</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/SamplesNTutorials/Tutorials">Tutorials</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Development<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">AlchemyJ Workbook</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Development/AlchemyjWorkbook/Introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/AlchemyjWorkbook/WriteYourFirstApi">Write your first Java API</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/AlchemyjWorkbook/AlchemyjStudio">AlchemyJ Studio</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/AlchemyjWorkbook/SysRuntimeWorksheet">SysRuntime Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/AlchemyjWorkbook/SysConfigWorksheet">SysConfig Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/AlchemyjWorkbook/AppConfigWorksheet">AppConfig Worksheet</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Business logic</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Development/BusinessLogic/Tutorial">Tutorial</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/BusinessLogic/InputAndOutput">Input and output</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/BusinessLogic/AddingBusinessLogic">Adding business logic</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/BusinessLogic/DbSchemaWorksheet">DB Schema Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/BusinessLogic/DataDictionaryWorksheet">Data Dictionary Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/BusinessLogic/AlchemyjModelingBestPractice">AlchemyJ modeling best practice</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Configuring Java API</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Development/ConfiguringJavaApi/Introduction">Introduction to AlchemyJ Java API</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/ConfiguringJavaApi/PackageDefinitionWorksheet">Package Definition Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/ConfiguringJavaApi/ClassDefinitionWorksheet">Class Definition Worksheet</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Configuring REST API</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Development/ConfiguringRestApi/Introduction">Introduction to AlchemyJ REST API</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/ConfiguringRestApi/Tutorial">Tutorial</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/ConfiguringRestApi/ControllerWorksheet">Controller Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/ConfiguringRestApi/EndpointWorksheet">Endpoint Worksheet</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Enabling REST security</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Development/EnablingRestSecurity/Tutorial">Tutorial</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/EnablingRestSecurity/SecurityAuthenticationWorksheet">Security Authentication Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/EnablingRestSecurity/SecurityUserDetailsServiceWorksheet">Security User Details Service Worksheet</a></li><li class="navListItem"><a class="navItem" href="/docs/Development/EnablingRestSecurity/SecurityResourceAuthWorksheet">Security Resource Auth worksheet</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Testing &amp; debugging<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/TestingAndDebugging/Tutorial">Tutorial</a></li><li class="navListItem"><a class="navItem" href="/docs/TestingAndDebugging/PreviewYourWorkInExcel">Preview your work in Excel</a></li><li class="navListItem"><a class="navItem" href="/docs/TestingAndDebugging/TestYourApiByRunningUnitTest">Test your API by running unit test</a></li><li class="navListItem"><a class="navItem" href="/docs/TestingAndDebugging/EnableTheDebuggingMode">Enable the Debugging Mode</a></li><li class="navListItem"><a class="navItem" href="/docs/TestingAndDebugging/DefineYourOwnTestingData">Define your own testing data</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Reference<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">AJ Excel Extended Functions</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/Index">Index</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/AuthenLdap">AuthenLdap</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/CallFunction">CallFunction</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/CallWsRest">CallWsRest</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/CallWsSoap">CallWsSoap</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/CheckDataItem">CheckDataItem</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/CountRec">CountRec</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/CreateRec">CreateRec</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/DeleteRec">DeleteRec</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/ExecuteSp">ExecuteSP</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/ExecuteSql">ExecuteSql</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/FilterArray">FilterArray</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/FilterJson">FilterJson</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/GetAddress">GetAddress</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/GetLastUsedCellAddress">GetLastUsedCellAddress</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/GetModelError">GetModelError</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/GetSystemError">GetSystemError</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/MakeJson">MakeJson</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/MakeJsonFromSchema">MakeJsonFromSchema</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/MakeJsonFromTable">MakeJsonFromTable</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/MergeRec">MergeRec</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/PopulateJsonToTable">PopulateJsonToTable</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/RaiseError">RaiseError</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/ReadFile">ReadFile</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/ReadRec">ReadRec</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/RegExpCount">RegExpCount</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/RegExpMatch">RegExpMatch</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/SendEmail">SendEmail</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/SortArray">SortArray</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/UpdateRec">UpdateRec</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/AlchemyjLibraryFunctionsIndex/WriteFile">WriteFile</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Debugging Actions</h4><ul><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/Index">Index</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/generate-debug-excel">generate-debug-excel</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/set-formula-to-cell">set-formula-to-cell</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/set-value-to-cell">set-value-to-cell</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/view-aj-library-inout">view-aj-library-inout</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/view-cell">view-cell</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/view-cookies">view-cookies</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/view-env-props">view-env-props</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/view-exception">view-exception</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/view-fun-point-inout">view-fun-point-inout</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/view-req-body">view-req-body</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/view-req-header">view-req-header</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/view-req-param">view-req-param</a></li><li class="navListItem"><a class="navItem" href="/docs/Reference/DebuggingActions/view-session">view-session</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/Reference/SupportedExcelFunctions">Supported Excel functions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">FAQ<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/Faq/Faq">FAQ</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="constructing-json-strings"></a><a href="#constructing-json-strings" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Constructing JSON Strings</h1>
<p>JSON (JavaScript Object Notation) is a lightweight data-interchange format and it is a commonly used in REST web service. AlchemyJ provides multiple ways to construct JSON string. They are</p>
<p><a href="../../Reference/AlchemyjLibraryFunctionsIndex/MakeJson">MakeJson</a></p>
<p><a href="../../Reference/AlchemyjLibraryFunctionsIndex/MakeJsonFromTable">MakeJsonFromTable</a></p>
<p><a href="../../Reference/AlchemyjLibraryFunctionsIndex/MakeJsonFromSchema">MakeJsonFromSchema</a></p>
<p>The above functions are often used to construct a REST API response.</p>
<h2><a class="anchor" aria-hidden="true" id="makejson"></a><a href="#makejson" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MakeJson</h2>
<p>MakeJson returns a JSON string given a corresponding name and value pair. If the value of
the JSON name-value pair contains multiple records, a JSON array will be returned. It only supports a single table.  For returning multiple tables, use MakeJsonFromSchema instead.</p>
<p>MakeJson function supports both row array and column array.</p>
<h3><a class="anchor" aria-hidden="true" id="case-1-get-a-json-array-with-makejson"></a><a href="#case-1-get-a-json-array-with-makejson" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Case 1: Get a JSON Array with MakeJson</h3>
<p>For example, below is a customer list that shall be returned by a function point.  We will use makejson to construct the function point response.</p>
<p><a href="ConstructingAndParsingJsonImg/image-20200114155341387.png"><img src="ConstructingAndParsingJsonImg/image-20200114155341387.png" alt="image-20200114155341387"></a></p>
<p>MakeJson has four parameters.  In this example, we only need to define the first two parameters of MakeJson. Cell B3 to F3 define the header range (first parameter) while cell B4 to F8 defines the data range (second parameter).</p>
<pre><code class="hljs">=MakeJson(header,data,data_type,exclude_column)
</code></pre>
<p>As MakeJson returns a string, highlight the cell you want the data to be returned, type in =MakeJson(B3:F3,B4:F8), the customer table will be converted to a JSON array as below</p>
<pre><code class="hljs">[{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"CHAN TAI MAN"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28127</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"5"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22205555"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"JERRY SZE"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32239</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22203333"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MERRY SO"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32205</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"4"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22201111"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MICKY MAI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32271</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"3"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22206666"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"TOM HUI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28827</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"1"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22204444"</span>}]
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="case-2-get-a-json-object-with-makejson"></a><a href="#case-2-get-a-json-object-with-makejson" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Case 2: Get a JSON Object with MakeJson</h3>
<p>For the same customer list as Case 1, if you target to get a JSON object, then you can do as follows</p>
<p><a href="ConstructingAndParsingJsonImg/image-20200114162219513.png"><img src="ConstructingAndParsingJsonImg/image-20200114162219513.png" alt="image-20200114162219513"></a></p>
<p>Input a data range as cell C12.</p>
<pre><code class="hljs">=GetAddress(<span class="hljs-symbol">B3</span>:<span class="hljs-symbol">F3</span>) &amp; <span class="hljs-string">","</span> &amp; GetAddress(<span class="hljs-symbol">B4</span>:<span class="hljs-symbol">F8</span>)
</code></pre>
<p>In this example, input the data item name as [customers] in B12. Then use =MakeJson(B12:B12,C12:C12), you will have a JSON Object as below</p>
<pre><code class="hljs">{<span class="hljs-attr">"customers"</span>:[{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"CHAN TAI MAN"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28127</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"5"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22205555"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"JERRY SZE"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32239</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22203333"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MERRY SO"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32205</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"4"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22201111"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MICKY MAI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32271</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"3"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22206666"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"TOM HUI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28827</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"1"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22204444"</span>}]}

</code></pre>
<h3><a class="anchor" aria-hidden="true" id="case-3-makejson-for-a-column-array"></a><a href="#case-3-makejson-for-a-column-array" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Case 3: MakeJson for a column array</h3>
<p>MakeJson function can also handle column array. In this example, the customer list is transposed as below. B2:B6 is the header range and C2:G6 is the data range.</p>
<p><a href="ConstructingAndParsingJsonImg/image-20200114175255325.png"><img src="ConstructingAndParsingJsonImg/image-20200114175255325.png" alt="image-20200114175255325"></a></p>
<p>As MakeJson returns a string, highlight the cell you want the data to be returned, type in =MakeJson(B2:B6,C2:G6), the customer table will be converted to a JSON array. It returns the same result as in case 1.</p>
<h2><a class="anchor" aria-hidden="true" id="makejsonfromtable"></a><a href="#makejsonfromtable" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MakeJsonFromTable</h2>
<p>MakeJsonFromTable is a quick way to turn a table of data into a json string. For returning multiple tables, use MakeJsonFromSchema instead.</p>
<pre><code class="hljs">=MakeJsonFromTable(header,data,data_name,data_type,exclude_column)
</code></pre>
<p>Take the same example in <a href="#case-2-get-a-json-object-with-makejson">Case 2</a>: Get a JSON Object with MakeJson, we can use =MakeJsonFromTable(B3:F3,B4:F8,&quot;customers&quot;)  to achieve the same result.</p>
<p><a href="ConstructingAndParsingJsonImg/image-20200114155341387.png"><img src="ConstructingAndParsingJsonImg/image-20200114155341387.png" alt="image-20200114155341387"></a></p>
<p>Return Result:</p>
<pre><code class="hljs">{<span class="hljs-attr">"customers"</span>:[{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"CHAN TAI MAN"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28127</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"5"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22205555"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"JERRY SZE"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32239</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"2"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22203333"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MERRY SO"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32205</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"4"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22201111"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"MICKY MAI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">32271</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"F"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"3"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22206666"</span>},{<span class="hljs-attr">"Name"</span>:<span class="hljs-string">"TOM HUI"</span>,<span class="hljs-attr">"Date of Birth"</span>:<span class="hljs-number">28827</span>,<span class="hljs-attr">"Gender"</span>:<span class="hljs-string">"M"</span>,<span class="hljs-attr">"Customer Level"</span>:<span class="hljs-string">"1"</span>,<span class="hljs-attr">"Telephone"</span>:<span class="hljs-string">"22204444"</span>}]}

</code></pre>
<h2><a class="anchor" aria-hidden="true" id="makejsonfromschema"></a><a href="#makejsonfromschema" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MakeJsonFromSchema</h2>
<p>MakeJsonFromSchema is good for constructing json string from tables that are related based on a foreign key. The input parameters defines the schema table which describe the relationship between the related tables.  The schema table needs to be defined first.</p>
<pre><code class="hljs">=MakeJsonFromSchema(tables_relationship_header,tables_relationship)
</code></pre>
<p>Here is a sample to construct a JSON string for Client and Order tables.</p>
<p><a href="ConstructingAndParsingJsonImg/image-20200114184032107.png"><img src="ConstructingAndParsingJsonImg/image-20200114184032107.png" alt="image-20200114184032107"></a></p>
<p>There are 3 records in Client tables and the key is Client ID. There are also 3 records in Order table and the foreign key is Client ID.</p>
<p>Table Relationship table must follow a required format. Refer <a href="../../Reference/AlchemyjLibraryFunctionsIndex/MakeJsonFromSchema">MakeJsonFromSchema</a> for the columns it requires. In this example, A15:I15 is the tables relationship header and A16:I17 is the tables relationship data range. Enter the formula =MakeJsonFromSchema(A15:I15,A16:I17) in cell B20.</p>
<p><a href="ConstructingAndParsingJsonImg/image-20200114184749069.png"><img src="ConstructingAndParsingJsonImg/image-20200114184749069.png" alt="image-20200114184749069"></a></p>
<p>The function generates a json string with a hierarchy based on the table relationship defined. In this example, the order table is linked to the client table based on client ID. The json result shows that only client 1234567890001 has an order list since the order table only contains client 1234567890001.</p>
<p><a href="ConstructingAndParsingJsonImg/image-20200114183945344.png"><img src="ConstructingAndParsingJsonImg/image-20200114183945344.png" alt="image-20200114183945344"></a></p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/SamplesNTutorials/RecipeBook/UsingArrayForLibraryFunction"><span class="arrow-prev">← </span><span>Returning multiple cells</span></a><a class="docs-next button" href="/docs/SamplesNTutorials/RecipeBook/ParsingJsonString"><span>Parsing JSON strings</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#makejson">MakeJson</a><ul class="toc-headings"><li><a href="#case-1-get-a-json-array-with-makejson">Case 1: Get a JSON Array with MakeJson</a></li><li><a href="#case-2-get-a-json-object-with-makejson">Case 2: Get a JSON Object with MakeJson</a></li><li><a href="#case-3-makejson-for-a-column-array">Case 3: MakeJson for a column array</a></li></ul></li><li><a href="#makejsonfromtable">MakeJsonFromTable</a></li><li><a href="#makejsonfromschema">MakeJsonFromSchema</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap" id="site_map"><table align="center" border="0"><tbody><tr><td align="left"><span height="46px"><a href="mailto:enquiry@alchemyj.com" id="emailUs">Email Us</a>    <a href="tel:+852 3162 6500" id="callUs">Call Us</a></span></td><td align="right"><span height="46px" id="copyright">Copyright © 2020 <a href="http://www.axisoft.com" target="_blank" data-content="http://www.axisoft.com" data-type="external" rel="noopener noreferrer" id="copyrightLink"> Axisoft (Asia Placific) Limited</a> All Rights Reserved.</span></td></tr></tbody></table></section></footer></div></body></html>